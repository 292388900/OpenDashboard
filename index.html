<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>OpenDashboard by Apereo-Learning-Analytics-Initiative</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>OpenDashboard</h1>
        <p></p>
        <p class="view">
        <a href="#new-card">Developing your own OpenDashboard Card</a>
        </p>
        <p class="view">
        <a href="#services">Services</a>
        </p>
        <p class="view">
        <a href="#js-api">JavaScript API</a>
        </p>
        <p class="view">
        <a href="#js-model">JavaScript Data Model</a>
        </p>
        <p class="view"><a href="https://github.com/Apereo-Learning-Analytics-Initiative/OpenDashboard">View the Project on GitHub <small>Apereo-Learning-Analytics-Initiative/OpenDashboard</small></a></p>

        <ul>
          <li><a href="https://github.com/Apereo-Learning-Analytics-Initiative/OpenDashboard/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/Apereo-Learning-Analytics-Initiative/OpenDashboard/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/Apereo-Learning-Analytics-Initiative/OpenDashboard">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h1>
            <a id="new-card" class="anchor" href="#new-card" aria-hidden="true"><span class="octicon octicon-link"></span></a>Developing your own OpenDashboard Card
        </h1>
        <p>Step-by-step instructions with examples for developing your own OpenDashboard Card.</p>

		<h3>Pick a type for your card</h3>

		<p>OpenDashboard relies heavily on convention over code so your card type is important - choose wisely. 
		In our example we'll be building a card that displays all available data for the given context for demonstration purposes so I'm going to call my card type demo.</p>

		<h3>Create the AngularJS Module for your card</h3>
		<p>This file contains the supporting Javascript for your card. Create a file called module.js in your card directory. 
		Use this file to define the AngularJS module and any supporting controllers and services.</p>

		<p>Also use this file to register your card with OpenDashboard and define its configuration data.</p>

		<p>For example:</p>
		
		<pre>
			<code>
(function(angular) {
'use strict';
    
angular
.module('od.cards.demo', ['OpenDashboardRegistry', 'OpenDashboardAPI'])
 .config(function(registryProvider){
    registryProvider.register('demo',{
        title: 'Roster View',
        description: 'This card demonstrates how to retrieve data from various sources.',
        imgUrl: '',
        cardType: 'demo',
        styleClasses: 'od-card col-xs-12',
	    config: [
	    ]
    });
 })
 .controller('DemoCardController', 
 	function($scope, $http, $log, _, ContextService, RosterService) {
	
	$scope.course = ContextService.getCourse();
	$scope.lti = ContextService.getInbound_LTI_Launch();

	if ($scope.lti.ext.ext_ims_lis_memberships_url 
		&& $scope.lti.ext.ext_ims_lis_memberships_id) {
		
		var basicLISData = {};
		basicLISData.ext_ims_lis_memberships_url = $scope.lti.ext.ext_ims_lis_memberships_url;
		basicLISData.ext_ims_lis_memberships_id = $scope.lti.ext.ext_ims_lis_memberships_id;
		
		var options = {};
		options.contextMappingId = $scope.contextMapping.id;
		options.dashboardId = $scope.activeDashboard.id;
		options.cardId = $scope.card.id;
		options.basicLISData = basicLISData;

		RosterService
		.getRoster(options,null) // pass null so the default implementation is used
		.then(
			function (rosterData) {
				if (rosterData) {
					$scope.course.buildRoster(rosterData);					
				}
			}
		);
		
	}
	else {
		$log.error('Card not configured for Roster');
	}
});

})(angular);
			</code>
		</pre>
	
		<p>Note, cardType should match the name of your card directory.</p>

		<h3>Create the HTML for your card</h3>
		<p>Start by creating a new directory in src/main/resources/public/cards that matches your card type (e.g. src/main/resources/public/cards/demo). 
		Then create an html file in the new directory called view.html. view.html should contain the UI markup for your card and reference the controller you created in your module.js file. 
		OpenDashboard supports Bootstrap 3 by default but if you wanted to use different styling you would do that here as well.</p>
		
		<pre>
			<code>

&lt;div class="col-xs-12" ng-controller="DemoCardController"&gt;
	&lt;h1>Demo Card&lt;/h1&gt;
&lt;/div&gt;			

			</code>
		</pre>

		<h3>Update the AngularJS application to include your module</h3>

		<p>Open src/main/resources/public/framework/od-app.js and add your card module to the application dependencies. For example:</p>
		<pre>
			<code>
angular
 .module('OpenDashboard', ['ngRoute', 'OpenDashboardFramework','angularCharts',
 'od.cards.lti', 'od.cards.openlrs', 'od.cards.roster', <strong>'od.cards.demo'</strong>])
			</code>
		</pre>

		<h3>Add your module js file to the main application page</h3>
		<p>Open src/main/resources/templates/od.html and add a script tag at the bottom of the page pointing to your module js file. For example:</p>
		
		<pre>
			<code>
&lt;script src="../static/cards/demo/module.js" th:src="@{/cards/demo/module.js}"&gt;&lt;/script&gt;		
			</code>
		</pre>
		
      </section>
      <section>
        <h1>
            <a id="services" class="anchor" href="#services" aria-hidden="true"><span class="octicon octicon-link"></span></a>Services
        </h1>
        <h2>ContextService</h2>
        <p>Use this service to access the data about the current context such as the current user and course objects.</p>
        <h3>Functions</h3>
        <h4>getCourse</h4>
       	<p>Returns the current Course object</p>
        <h4>getCurrentUser</h4>
       	<p>Returns the current User object</p>
        <h4>getInbound_LTI_Launch</h4>
       	<p>Returns an object containing the inbound LTI launch parameters</p>
        <h2>LearningAnalyticsProcessorService</h2>
        <p>Use this service to access the output of a learning analytics processor for the given context. 
        	The default strategy is to use the OAAI Learning Analytics Processor. The strategy can be configured using the setStrategy function</p>
        <h3>Functions</h3>
        <h4>setStrategy</h4>
        <h5>Parameters</h5>
        <ul style="list-style-type:none">
            <li>lapStrategyToUse : Service</li>
        </ul>  
        <p>Sets the concrete strategy implementation to be delegated to</p>
        <h4>getResults</h4>
        <h5>Parameters</h5>
        <ul style="list-style-type:none">
            <li>contextMappingId : String</li>
            <li>dashboardId : String</li>
            <li>cardId : String</li>
        </ul>  
        <p>Returns the output of a learning analytics processor for the given context</p>
        <h4>getResultsForUser</h4>
        <h5>Parameters</h5>
        <ul style="list-style-type:none">
            <li>contextMappingId : String</li>
            <li>dashboardId : String</li>
            <li>cardId : String</li>
            <li>userId : String</li>
        </ul>  
        <p>Returns the output of a learning analytics processor for the given user in the context</p>
        <h4>mapToRoster</h4>
        <h5>Parameters</h5>
        <ul style="list-style-type:none">
            <li>roster : Array[Member]</li>
            <li>lapResults : Array</li>
        </ul>  
        <p>Associate the lap results for each user in a roster</p>
        <h2>EventService</h2>
        <p>Use this service to access event data typically from an LRS. The default strategy uses OpenLRS but this can be configured using the setStrategy function</p>
        <h3>Functions</h3>
        <h4>setStrategy</h4>
        <h5>Parameters</h5>
        <ul style="list-style-type:none">
            <li>strategyToUse : Service</li>
        </ul>  
        <p>Sets the concrete strategy implementation to be delegated to</p>
        <h4>getEventFromService</h4>
        <h5>Parameters</h5>
        <ul style="list-style-type:none">
            <li>eventData : Object</li>
        </ul>  
        <p>Returns an Event object based on the external event</p>
        <h4>getEvents</h4>
        <h5>Parameters</h5>
        <ul style="list-style-type:none">
            <li>contextMappingId : String</li>
            <li>dashboardId : String</li>
            <li>cardId : String</li>
        </ul>  
        <p>Returns the events as normalized Event objects for the given context</p>
        <h4>getEventsForUser</h4>
        <h5>Parameters</h5>
        <ul style="list-style-type:none">
            <li>contextMappingId : String</li>
            <li>dashboardId : String</li>
            <li>cardId : String</li>
            <li>userId : String</li>
        </ul>  
        <p>Returns the events as normalized Event objects for the given user in the context</p>
        <h2>DemographicsService</h2>
        <p>Use this service to get demographic data about users</p>
        <h3>Functions</h3>
        <h4>getDemographics</h4>
       	<p>Returns an array of Demographics objects for all users in the source system</p>
        <h4>getDemographicsForUser</h4>
        <h5>Parameters</h5>
        <ul style="list-style-type:none">
            <li>user_id : String</li>
        </ul>  
        <p>Returns a Demographics object for the given user</p>
        <h5>Example</h5>
        <pre>
            <code>
DemographicsService
.getDemographics()
.then(
	function (demographicsData) {
		$scope.demographics = demographicsData;
	}
	
);
            </code>
        </pre>
        <h2>OutcomesService</h2>
        <p>Use this service to retrieve outcomes (line items and results) for the current context</p>
        <h3>Functions</h3>
        <h4>getOutcomes</h4>
        <h5>Parameters</h5>
        <ul style="list-style-type:none">
            <li>options : Object</li>
            <li>impl : Function</li>
        </ul>  
        <p>Returns an array of line item objects which optionally can contain results</p>
        <pre>
        	<code>
 {
 "id":"li-de5db688-b7ec-449a-94d3-deb9af208f2b-2",
 "type":"Assignment",
 "title":"li-2",
 "context":"de5db688-b7ec-449a-94d3-deb9af208f2b",
 "maximumScore":52,
 "results":[
   {"id":"admin-li-de5db688-b7ec-449a-94d3-deb9af208f2b-2",
   "user_id":"admin",
   "score":15.228},
   {"id":"e2d91b09-b62d-4db1-947f-3142df07cb16-li-de5db688-b7ec-449a-94d3-deb9af208f2b-2",
   "user_id":"e2d91b09-b62d-4db1-947f-3142df07cb16",
   "score":43.897}
   ]
}        	
			</code>
        </pre>
        <h5>Example</h5>
        <pre>
            <code>
OutcomesService
.getOutcomes(options,null)
.then(
	function(outcomesData) {
		$scope.outcomes = outcomesData;
	}
);
            </code>
        </pre>
        <h2>RosterService</h2>
        <p>Use this service to access the roster for the current context</p>
        <h3>Functions</h3>
        <h4>getRoster</h4>
        <h5>Parameters</h5>
        <ul style="list-style-type:none">
            <li>options : Object</li>
            <li>impl : Function</li>
        </ul>  
        <p>Returns an array of Member objects</p>
        <h5>Example</h5>
        <pre>
            <code>
var basicLISData = {};
basicLISData.ext_ims_lis_memberships_url = $scope.lti.ext.ext_ims_lis_memberships_url;
basicLISData.ext_ims_lis_memberships_id = $scope.lti.ext.ext_ims_lis_memberships_id;

var options = {};
options.contextMappingId = $scope.contextMapping.id;
options.dashboardId = $scope.activeDashboard.id;
options.cardId = $scope.card.id;
options.basicLISData = basicLISData;

RosterService
.getRoster(options,null) // pass null so the default implementation is used
.then(
	function (rosterData) {
		if (rosterData) {
			$scope.course.buildRoster(rosterData);					
		}
	}
);
            </code>
        </pre>
      </section>
      <section>
        <h1>
            <a id="js-api" class="anchor" href="#js-api" aria-hidden="true"><span class="octicon octicon-link"></span></a>JavaScript API
        </h1>
        <p>Javascript API module providing common functions and access to entities.</p>

        <h3>Functions</h3>
        <h4>setLTIToolLaunch</h4>
        <h5>Parameters</h5>
        <ul style="list-style-type:none">
            <li>lti_launch : Object</li>
        </ul>  
        <h5>Example</h5>
        <pre>
            <code>
			OpenDashboardApi.setInbound_LTI_Launch(inbound_lti_launch_request);
            </code>
        </pre>
        <h4>getLTIToolLaunch</h4>
        <h5>Example</h5>
        <pre>
            <code>
            var lti_launch_data = OpenDashboardApi.getLTIToolLaunch();
            </code>
        </pre>
        <h4>getCourse</h4>
        <p>Returns a Course object representing the current context</p>
        <h4>createMemberInstance</h4>
        <h5>Parameters</h5>
        <ul style="list-style-type:none">
            <li>options : Object</li>
        </ul>  
        <h5>Example</h5>
        <pre>
            <code>
            var member = OpenDashboardApi.createMemberInstance();
            </code>
        </pre>
        <h4>getCurrentUser</h4>
		<p>Returns a Member object representing the current user within the context</p>
        <h4>createEventInstance</h4>
        <h5>Parameters</h5>
        <ul style="list-style-type:none">
            <li>options : Object</li>
        </ul>  
        <pre>
            <code>
            var event 
                = OpenDashboardApi.createEventInstance();
            </code>
        </pre>
        <h4>createContextMappingInstance</h4>
        <h5>Parameters</h5>
        <ul style="list-style-type:none">
            <li>options : Object</li>
        </ul>  
        <pre>
            <code>
            var options = {'id':12345};
            var cm 
                = OpenDashboardApi.createContextMappingInstance(options);
            </code>
        </pre>
      </section>
      <section>
        <h1>
            <a id="js-model" class="anchor" href="#js-model" aria-hidden="true"><span class="octicon octicon-link"></span></a>JavaScript Data Model
        </h1>
        <p>Javascript modules representing framework and common relevant entities. Use the OpenDashboardApi module to access these entities.</p>
        <h2>Context Mapping</h2>
        <p>Represents the relationship between an external context (e.g. a course or course section) and a set of OpenDashboard dashboards.</p>
        <h3>Members</h3>
        <h4>id</h4>
        <p>Get the primary key</p>
        <h4>key</h4>
        <p>Get the consumer key</p>
        <h4>dashboards</h4>
        <p>Get the array of dashboard objects associated with this context</p>
        <h4>context</h4>
        <p>Get the external context id (e.g. course id) associated with this mapping</p>
        <h4>modified</h4>
        <p>Get last modifed timestamp</p>
        <h3>Functions</h3>
        <h4>addDashboard</h4>
        <p>Add a new dashboard to this context mapping. This is a framework function - you probably don't need to call it yourself.</p>
        <h5>Parameters</h5>
        <ul style="list-style-type:none">
            <li>dashboard : Object</li>
        </ul>  

        <h2>Course</h2>
        <p>Represents an external context (e.g. an LMS course)</p>
        <h3>Members</h3>
        <h4>id</h4>
        <p>The external context id (e.g. course id)</p>
        <h4>title</h4>
        <p>The context title</p>
        <h4>instructors</h4>
        <p>An array of Member objects containing the instructors for the context</p>
        <h4>learners</h4>
        <p>An array of Member objects containing the learner for the context</p>
        <h4>events</h4>
        <p>An array of Event objects for this context</p>
        <h4>events_median</h4>
        <p>An integer representing the median number of events for learners in the context. This is used to determine a relative activity level for each learner.</p>
        <h3>Functions</h3>   
        <h4>buildRoster</h4>
        <p>Construct the course roster from an array of Members</p>
        <h5>Parameters</h5>
        <ul style="list-style-type:none">
            <li>members : Array[Member]</li>
        </ul>  
        <h4>addEvent</h4>
        <p>Add a new event to the array of events for this context</p>
        <h5>Parameters</h5>
        <ul style="list-style-type:none">
            <li>event : Event</li>
        </ul>  

        <h2>Member</h2>
        <p>Represents a user within a context</p>
        <h3>Members</h3>
        <h4>user_id</h4>
        <p>The external user id</p>
        <h4>user_image</h4>
        <p>The URL for user image (avatar)</p>
        <h4>role</h4>
        <p>The member's role within this context</p>
        <h4>roles</h4>
        <p>The common separated list of roles within this context</p>
        <h4>person</h4>
        <p>The Person object for this member</p>
        <h4>events</h4>
        <p>An array of events for this member within this context</p>
        <h4>relative_activity_level</h4>
        <p>The activity level for this member relative to the rest of the members</p>
        <h4>risk</h4>
        <p>The risk level as determined by an external analytics processor</p>
        <h4>last_activity</h4>
        <p>The timestamp from the last activity within the context for this member</p>
        <h3>Functions</h3>
        <h4>fromLTI</h4>
        <p>Construct a member object from the inbound LTI launch object</p>
        <h5>Parameters</h5>
        <ul style="list-style-type:none">
            <li>ltiLaunch : Object</li>
        </ul>  
        <h4>fromService</h4>
        <p>Convert an external member record to the internal format</p>
        <h5>Parameters</h5>
        <ul style="list-style-type:none">
            <li>options : Object</li>
        </ul>  
        <h4>isInstructor</h4>
        <p>Returns true if the member is an Instructor within this context</p>
        <h4>isStudent</h4>
        <p>Returns true if the member is a Learner within this context</p>
        
        <h2>Person</h2>
        <p>User personally identifiable information</p>
        <h3>Members</h3> 
        <h4>contact_email_primary</h4>
        <p>The person's email address</p>
        <h4>name_given</h4>
        <p>The person's first name</p>
        <h4>name_family</h4>
        <p>The person's last name</p>
        <h4>name_full</h4>
        <p>The person's full name</p>
        <h4>demographics</h4>
        <p>Demographics object for this person</p>

        <h2>Demographics</h2>
        <p>A collection of demographics for the person</p>
        <h3>Members</h3>   
        <h4>user_id</h4>
        <p>The external user id</p>
        <h4>percentile</h4>
        <p></p>
        <h4>sat_verbal</h4>
        <p>The SAT Verbal score for this person</p>
        <h4>sat_math</h4>
        <p>The SAT Math score for this person</p>
        <h4>act_composite</h4>
        <p>The ACT score for this person</p>
        <h4>age</h4>
        <p>The person's age</p>
        <h4>race</h4>
        <p>The race code for this person</p>
        <h4>gender</h4>
        <p>The gender code for this person</p>
        <h4>enrollment_status</h4>
        <p>This person's enrollment status code</p>
        <h4>earned_credit_hours</h4>
        <p>The number of credits this person has earned</p>
        <h4>gpa_cumulative</h4>
        <p>The person's overall GPA</p>
        <h4>gpa_semester</h4>
        <p>The person's GPA for this semester</p>
        <h4>standing</h4>
        <p>This person's academic standing</p>
        <h4>pell_status</h4>
        <p>This person's Pell eligibility code</p>
        <h4>class_code</h4>
        <p>This person's class code</p>
        
        <h2>Event</h2>
        <p>An interaction with a system by a user optionally within a context</p>
        <h3>Members</h3>   
        <h4>user_id</h4>
        <p>The user id for the event actor</p>
        <h4>context_id</h4>
        <p>The context id (e.g. course id) where this event occurred</p>
        <h4>organization_id</h4>
        <p>The id for the organization (e.g. school, institution, etc)</p>
         <h4>name_full</h4>
        <p>The full name of the event actor (e.g. John Wall)</p>
        <h4>type</h4>
        <p>The pre-transform event type (xAPI, Caliper, etc)</p>
        <h4>action</h4>
        <p>The action that was performed</p>
        <h4>object</h4>
        <p>The object that this event was performed on</p>
        <h4>raw</h4>
        <p>The raw (xAPI, Caliper, etc format) event</p>
        <h4>timestamp</h4>
        <p>The timestamp for when this event occurred</p>
        <h3>Functions</h3>
        <h4>fromService</h4>
        <p>Use this method to transform an external event into the normalized event format</p>
	</section>
	</div>
   <script src="javascripts/scale.fix.js"></script>
    
  </body>
</html>
